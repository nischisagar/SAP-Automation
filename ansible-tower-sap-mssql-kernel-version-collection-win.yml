---
- name: Get the MS-SQL version from Windows Servers (Single SID)
  hosts: sap_mssql_host_name_single_sid
  become: yes
  become_method: runas
  become_user: system
  roles:
  - role: get-the-sap-version-mssql-win
    delegate_to: ampsw046decc0

- name: Create temporary localreport file
  hosts: local_ansible_engine_server
  become: yes
  become_method: sudo
  gather_facts: false
  vars:
    temp_file: "/ansible/reports/win_report/{{ inventory_hostname }}.log"
  tasks:
    - name: Create the temporary localreport file
      copy:
        content: ''
        dest: "{{ temp_file }}"
      run_once: yes
     
    - name: Add the temporary localreport file
      lineinfile:
        dest: "{{ temp_file }}"
        line: "{{ item }}"
      throttle: 1
      loop: 
        - "{{ sap_verison.results[0].stdout }}"
        - "{{ db_verison.results[0].stdout }}"
        - "{{ kernal_verison.results[0].stdout_lines[2] }}"


