---
- name: Add the title content in to SAP Version Details Report
  hosts: ampsv010bld0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  gather_facts: false
  roles:
  - role: report-create-sap-title-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsa033qecc0.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: qneadm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv03340pjt.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: de6adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv03340pjt.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: te6adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv03340pjt.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: tnjadm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv033bw0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dn1adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb 

- name: Get the SAP version from the SAP Servers
  hosts: ampsv033bw0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: qn1adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb 

- name: Get the SAP version from the SAP Servers
  hosts: ampsv033bw0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dn2adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb 

- name: Get the SAP version from the SAP Servers
  hosts: ampsv033bw0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: qn2adm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv03357dev.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dncadm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv03357qua.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: qncadm
    entity_name: "033_SABRE"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv031ecc0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dc3adm
    entity_name: "031_IBIS"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: ampsv031ecc0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: tc3adm
    entity_name: "031_IBIS"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: a01830pj.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dv2adm
    entity_name: "018_TESIS"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: a01830pj.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: qv2adm
    entity_name: "018_TESIS"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Get the SAP version from the SAP Servers
  hosts: a01830pj.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  vars: 
    ansible_python_interpreter: "/usr/bin/python"
    sid_adm_usr: dvdadm
    entity_name: "018_TESIS"
  roles:
  - role: get-the-sap-version-oradb
  - role: report-create-sap-oradb

- name: Send e-mail
  hosts: ampsv010bld0d.ux1.ibmfr.bluecare.ibm.com
  become: yes
  become_method: sudo
  gather_facts: false
  tasks:
    - name: Send e-mail to a bunch of users, attaching files
      mail:
        host: smtp.mail.saint-gobain.net
        port: 25
        subject: Ansible Report - SAP and Oracle DB version
        body: Hello Team, Please find the attached SAP and Oracle DB version details report from Oracle DB servers.
        from: ampsv010bld0d.p1.saint-gobain.net@saint-gobain.com (Ansible Tower)
        to:
        - Kalaikannan Anbarasan <kalanbar@in.ibm.com>
        - Swetha J <swethaj.iyer@in.ibm.com> 
        cc: 
        - Poonjolai Govindasamy <pogovind@in.ibm.com>
        - Vignesh Rajendran <vigrajen@in.ibm.com>
        - Sureshkumar Krishnamurthy <sureshkk@in.ibm.com>
        attach:
        - "{{ report_file }}"
        headers:
        - Reply-To=pogovind@in.ibm.com
        - X-Special="Please contact Poonjolai Govindasamy if any issues are in this report."
        charset: us-ascii
    
    - name: Remove the Oracle DB report
      file:
        path: "{{ report_file }}"
        state: absent