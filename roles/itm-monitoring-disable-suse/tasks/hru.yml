---
- name: Enable/Disable ITM Monitoring
  shell:  |
    echo "{{ sid_list }}" > /tmp/itm_sidlist.txt
    cat /tmp/itm_sidlist.txt|cut -d, -f1 > /tmp/itmsid.txt
    cat /tmp/itm_sidlist.txt|cut -d, -f2 >> /tmp/itmsid.txt
    cat /tmp/itm_sidlist.txt|cut -d, -f3 >> /tmp/itmsid.txt
    cat /tmp/itm_sidlist.txt|cut -d, -f4 >> /tmp/itmsid.txt
    grep . /tmp/itmsid.txt|uniq > /tmp/itm_sidlist.txt
    cat /tmp/itm_sidlist.txt
  register: sidlist1

- debug:
    msg:  "{{ sidlist1.stdout_lines }}"

- name: Get first word
  shell:  |
    cat /tmp/itm_sidlist.txt|head -1
  register: fword

- debug:
    msg: "{{ fword }}"

- name: Setting facts - fword
  set_fact:
    fword: "{{ fword['stdout'] }}"

- debug:
    msg: "{{ fword }}"

- name: Disable full monitoring
  shell:  |
    sed -e 's/^/#/' /tmp/K08_p.param > /tmp/K08_p.param_out
  register: disable_all
  when: fword == "ALL" or fword == "all"

- name: Disable sap monitoring alone
  shell:  |
    sed -e '/mysap/s/^/#/' /tmp/K08_p.param > /tmp/K08_p.param_out
  register: disable_sap
  when: fword == "mysap"

- name: Disable suse monitoring alone
  shell:  |
    cp -rpf /tmp/K08_p.param /tmp/K08_p.paramcheck
    sed -e '/suse/s/^/#/' /tmp/K08_p.param > /tmp/K08_p.param_out
  register: disable_suse
  when: fword == "OS" or fword == "os"

- debug:
    msg:  "{{ disable_suse.stdout_lines }}"

- name: Disable specific SID monitoring alone
  shell:  |
    for i in `cat /tmp/itm_sidlist.txt`
    do
    echo $i
    j=`echo $i|tr '[:upper:]' '[:lower:]'`
    echo $j
    sed -e '/'$i'/s/^/#/' -e '/'$j'/s/^/#/' /tmp/K08_p.param > /tmp/K08_p.param_out
    mv /tmp/K08_p.param_out /tmp/K08_p.param
    done
  register: disable_sid
  when: fword != "suse" or fword != "mysap" or fword != "ALL" or fword != "all"

