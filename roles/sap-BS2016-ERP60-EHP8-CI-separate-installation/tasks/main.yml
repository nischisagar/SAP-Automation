---
- name: "Rename existing input file in target location"
  shell: |
    cnt=`ls -lrt /010_SHARED_INFRA/SAP_Installaion/iniparamfiles/inifile_ci.params|wc -l`
    if [ $cnt -eq 1 ]
    then 
    mv /010_SHARED_INFRA/SAP_Installaion/iniparamfiles/inifile_ci.params /010_SHARED_INFRA/SAP_Installaion/iniparamfiles/inifile_ci.params_`date +%d%m%M`
    else
    echo "No mentioned input file found"
    fi
  register: renameinputfile

- debug:
    msg: "{{ renameinputfile }}"

- name: "Process Input param file"
  template:
    src: "{{ role_path }}/templates/{{ item }}"
    dest: "/010_SHARED_INFRA/SAP_Installaion/iniparamfiles/"
    owner: root
    group: sapinst
    mode: '0777'
  with_items:
  - inifile_ci.params
  register: inputfile

- debug:
    msg: "{{ inputfile }}"

- name: echo execute installation step
  shell: |
    cd {{ swpm_path }}
    #cd {{ swpm_path }};/010_SHARED_INFRA/SAP/install/SWPM_AIX/sapinst SAPINST_INPUT_PARAMETERS_URL=/010_SHARED_INFRA/SAP/install/inifile_ci.params SAPINST_EXECUTE_PRODUCT_ID=NW_ABAP_CI:BS2016.ERP608.ORA.PD SAPINST_SKIP_DIALOGS=true
  register: install_out

- debug:
    msg: "{{ install_out }}"