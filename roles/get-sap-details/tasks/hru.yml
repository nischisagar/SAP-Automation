---
- name: Set the nfs_use_reserved_ports value as 1
  shell: nfso -p -o nfs_use_reserved_ports=1
  register: nfs_use_reserved_ports

- name: Mount the NFS share /tempfs_ansible
  aix_filesystem:
    device: /data/REAR/bigfix
    nfs_server: ampsv010bld0d.p1.saint-gobain.net
    filesystem: /tempfs_ansible
    state: present

- name: Get the SAP Details
  shell: |
    . ~/.cshrc
    disp+work
  become_user: "{{ sap_sid_adm_usr }}"
  become: true
  register: check_sap_details
  changed_when: False

- debug:
    msg: "{{ check_sap_details.stdout_lines }}"

- name: Unmount the NFS share /tempfs_ansible
  aix_filesystem:
    filesystem: /tempfs_ansible
    rm_mount_point: yes
    state: absent

- name: Set the nfs_use_reserved_ports value as 0
  shell: nfso -p -o nfs_use_reserved_ports=0
  when: nfs_use_reserved_ports.changed