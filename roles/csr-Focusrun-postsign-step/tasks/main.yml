---
- name: Getting current host info
  shell: hostname
  register: hname

- debug:
    msg: "{{ hname }}"

- name: Setting facts - hname
  set_fact:
    hname: "{{ hname['stdout'] }}"

- debug:
    msg: "{{ hname }}"

- name: Create PKCS12 file
  shell: |
    cd {{ install_path }};
    signfile=`ls {{ hname }}*`
    echo "signfile = $signfile"
    openssl pkcs12 -export -out certificate.pfx -inkey {{ install_path }}/{{ keyname }} -in {{ install_path }}/$signfile -certfile {{ install_path }}/root_inter.cer
    {{ exe_path }}/sapgenpse import_p12 -r {{ install_path }}/Saint_Gobain_Server_CA.cer -r {{ install_path }}/Saint_Gobain_Root_CA.cer -p {{ install_path }}/SAPSSLS.pse {{ install_path }}/certificate.pfx
  register: move1

- debug:
    msg: "{{ move1 }}"

