---
- name: Check SAP HOST AGENT VERSION
  shell: |
    hostname > /tmp/crypto_{{ sid_adm_usr_oradb_abap }}_{{ sid_adm_usr_oradb_abap }}.txt
    env|grep -i DB_SID|cut -d"=" -f2 >> /tmp/crypto_{{ sid_adm_usr_oradb_abap }}.txt
    sapgenpse|grep -i Commoncrypto_{{ sid_adm_usr_oradb_abap }}Lib|tail -1|awk '{print $2}' >> /tmp/crypto_{{ sid_adm_usr_oradb_abap }}.txt
    cat /tmp/crypto_{{ sid_adm_usr_oradb_abap }}_{{ sid_adm_usr_oradb_abap }}.txt
  loop: "{{ sid_adm_usr_oradb_abap }}"
  register: crypto_version

- debug:
    msg:  "{{ crypto_version }}"

- name: Get Host Name
  shell:  "cat /tmp/crypto_{{ sid_adm_usr_oradb_abap }}.txt|head -1"
  loop: "{{ sid_adm_usr_oradb_abap }}"
  register: get_hname_output

- name: Get SID
  shell:  "cat /tmp/crypto_{{ sid_adm_usr_oradb_abap }}.txt|head -2|tail -1"
  loop: "{{ sid_adm_usr_oradb_abap }}"
  register: get_SID

- name: Get crypto level
  shell:  "cat /tmp/crypto_{{ sid_adm_usr_oradb_abap }}.txt|tail -1"
  loop: "{{ sid_adm_usr_oradb_abap }}"
  register: get_crypto_level