---
- name: Find number of SID present
  shell:  |
    a=`df -g|grep -i sapmnt|awk '{print $NF}'|cut -d"/" -f3|awk '{print tolower($0)}'`
    for i in $a
    do
    b="$i""adm"
    echo $b >> /tmp/siduserlist.txt
    done
    chmod 775 /tmp/siduserlist.txt
    for j in `cat /tmp/siduserlist.txt`
    do
    su - $j -c "hostname >> /tmp/crypto-$j.txt"
    su - $j -c "env|grep -i DB_SID|cut -d"=" -f2 >> /tmp/crypto-$j.txt"
    su - $j -c "sapgenpse|grep -i CommoncryptoLib|tail -1|awk '{print $2}' >> /tmp/crypto-$j.txt"
    done
    usercnt=`cat /tmp/siduserlist.txt|wc -l|awk '{print $0}'`
    echo $usercnt
    userdiff=`expr 5 - $usercnt`
    echo $userdiff
    k=0
    while let "(k=$k+1) <= 2"
    do
    echo "dummy" >> /tmp/siduserlist.txt
    done
  register: crypto_version

- debug:
    msg:  "{{ crypto_version }}"
  